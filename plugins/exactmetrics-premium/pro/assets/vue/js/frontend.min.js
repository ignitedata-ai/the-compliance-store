import{V as n,a as w,n as i,m as r,i as C}from"./chunks/vendor-69fa03c8.min.js";import{R as D,D as y}from"./chunks/date-intervals-e5b578d4.min.js";import{W as P}from"./chunks/WidgetReportError-cc4bf599.min.js";import{L as E}from"./chunks/LaunchWizardButton-8a322cf6.min.js";import{M as R,s as d}from"./chunks/exactmetrics-helper-plugin-75824581.min.js";const T=s=>new Promise(t=>{let e=new FormData,_=n.prototype.$mi.page_id?n.prototype.$mi.page_id:window.location.pathname;e.append("action","exactmetrics_pageinsights_refresh_report"),e.append("security",n.prototype.$mi.nonce),e.append("report","pageinsights"),e.append("post_id",_),e.append("json",1),w.post(n.prototype.$mi.ajax,e).then(c=>{t(c.data)}).catch(function(c){s.dispatch("$_app/block",!1,{root:!0}),c.response})}),A={fetchReportData:T},S=s=>new Promise(t=>{s.dispatch("$_queue/add",()=>A.fetchReportData(s).then(function(e){if(e.data.message==="license_level"){t(!1);return}e.success?(s.commit("UPDATE_REPORT_DATA",{report:"pageinsights",data:e.data}),t(!0)):(n.prototype.$mi_error_toast(!1,e.data.message,e.data.footer),t(!1))}),{root:!0})}),F={getReportData:S},U=s=>s.date,O=s=>s.pageinsights,I=s=>s.loaded,M=s=>s.error,L=s=>s.noauth,N={date:U,pageinsights:O,loaded:I,error:M,noauth:L},k=(s,t)=>{t.report&&t.data&&s[t.report]&&n.set(s,t.report,t.data)},V=(s,t)=>{t.start&&t.end&&(n.set(s.date,"start",t.start),n.set(s.date,"end",t.end))},W=(s,t)=>{n.set(s.date,"interval",t)},B=(s,t)=>{s.loaded=t},H=(s,t)=>{s.error=t},j=s=>{s.noauth=!0,s.loaded=!0},z={UPDATE_REPORT_DATA:k,UPDATE_DATE:V,UPDATE_INTERVAL:W,UPDATE_LOADED:B,SET_ERROR:H,ENABLE_NOAUTH:j},G={loaded:!1,pageinsights:{},error:!1,noauth:!1},Y={namespaced:!0,state:G,actions:F,getters:N,mutations:z},K={name:"FrontendStatsColumn",props:{extraClass:{type:String,default:""},label:String,value:[String,Number]},computed:{columnClass(){return"exactmetrics-stats-column "+this.extraClass}}};var q=function(){var t=this,e=t._self._c;return e("div",{class:t.columnClass},[t.label?e("div",{staticClass:"exactmetrics-stats-label",domProps:{textContent:t._s(t.label)}}):t._e(),t.value?e("div",{staticClass:"exactmetrics-stats-value",domProps:{innerHTML:t._s(t.value)}}):t._e(),t._t("default")],2)},Z=[],J=i(K,q,Z,!1,null,null,null,null);const p=J.exports,{__:Q}=wp.i18n,X={name:"NotificationsIndicator",data(){return{text_view_notifications:Q("View notifications","exactmetrics-premium")}},computed:{...r({notifications:"$_notifications/notifications",view_url:"$_notifications/view_url",sidebar_url:"$_notifications/sidebar_url"}),has_notifications(){return this.notifications&&this.notifications.length>0}}};var tt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"exactmetrics-notifications-indicator"},[e("a",{attrs:{href:t.sidebar_url,title:t.text_view_notifications}},[e("svg",{attrs:{width:"35",height:"39",viewBox:"0 0 35 39",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M17.6898 39C20.3431 39 22.4954 36.8177 22.4954 34.125H12.8841C12.8841 36.8177 15.0364 39 17.6898 39ZM33.8706 27.5963C32.4192 26.015 29.7035 23.6361 29.7035 15.8438C29.7035 9.9252 25.6108 5.18731 20.0922 4.02492V2.4375C20.0922 1.09154 19.0164 0 17.6898 0C16.3631 0 15.2873 1.09154 15.2873 2.4375V4.02492C9.76874 5.18731 5.67602 9.9252 5.67602 15.8438C5.67602 23.6361 2.96031 26.015 1.50893 27.5963C1.05818 28.0876 0.858356 28.6749 0.862112 29.25C0.870376 30.4992 1.83721 31.6875 3.27357 31.6875H32.1059C33.5423 31.6875 34.5099 30.4992 34.5174 29.25C34.5212 28.6749 34.3213 28.0869 33.8706 27.5963Z",fill:"#393F4C"}})]),t.has_notifications?e("span",{staticClass:"exactmetrics-notifications-unread",domProps:{textContent:t._s(t.notifications.length)}}):t._e()])])},et=[],st=i(X,tt,et,!1,null,null,null,null);const f=st.exports,{__:o}=wp.i18n,nt={name:"FrontendStatsPageInsights",components:{NotificationsIndicator:f,FrontendStatsColumn:p},data(){return{text_insights_for:o("Last 30 Days Analytics for ","exactmetrics-premium"),text_entrances:o("Entrances","exactmetrics-premium"),text_page_views:o("Page Views","exactmetrics-premium"),text_time_on_page:o("Time on Page","exactmetrics-premium"),text_page_load_time:o("Page Load Time","exactmetrics-premium"),text_exits:o("Exits","exactmetrics-premium"),text_30days:o("Last 30 Days","exactmetrics-premium"),text_yesterday:o("Yesterday","exactmetrics-premium"),interval:"30days",page_title:this.$mi.page_title}},computed:{...r({reportdata:"$_frontend/pageinsights"}),displayData(){let s={entrances:"0",pageviews:"0",timeonpage:"0",pageloadtime:"0",exits:"0"};return this.reportdata[this.interval]&&(s=this.reportdata[this.interval]),s}},mounted(){if(!this.$mi.authed){this.$store.commit("$_frontend/ENABLE_NOAUTH");return}Object.keys(this.reportdata).length!==0&&this.reportdata.constructor===Object||this.$store.dispatch("$_frontend/getReportData").then(()=>{this.$store.commit("$_frontend/UPDATE_LOADED",!0)})}};var it=function(){var t=this,e=t._self._c;return e("div",{staticClass:"exactmetrics-frontend-stats-inner"},[e("h3",[e("span",{domProps:{textContent:t._s(t.text_insights_for)}}),e("span",{domProps:{textContent:t._s(t.page_title)}})]),e("div",{staticClass:"exactmetrics-frontend-stats-grey-area exactmetrics-pageinsights-data"},[e("frontend-stats-column",{attrs:{label:t.text_page_views,value:t.displayData.pageviews}}),e("frontend-stats-column",{attrs:{label:t.text_time_on_page,value:t.displayData.timeonpage}}),e("frontend-stats-column",{attrs:{label:t.text_entrances,value:t.displayData.entrances}}),e("frontend-stats-column",{attrs:{label:t.text_exits,value:t.displayData.exits}}),e("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-notifications"},[e("notifications-indicator")],1)],1)])},ot=[],at=i(nt,it,ot,!1,null,null,null,null);const rt=at.exports,{__:m}=wp.i18n,ct={name:"FrontendUpsell",data(){return{is_admin:this.$mi.is_admin,text_button:m("Upgrade to PRO","exactmetrics-premium"),text_install:m("Activate Page Insights Addon","exactmetrics-premium"),text_view_reports:m("View All Reports","exactmetrics-premium"),install_url:this.$mi.addons_url}},computed:{...r({license:"$_license/license",license_network:"$_license/license_network",addons:"$_addons/addons"}),upgradeUrl(){return this.$getUpgradeUrl("frontend-reports","admin-bar")},licenseType(){return this.$mi.network?this.license_network.type:this.license.type},reportsUrl(){return this.$mi.reports_url},isPageInsights(){return!!(typeof this.addons["page-insights"]<"u"&&this.addons["page-insights"].active)},canManageOptions(){return!!(this.$mi.roles_manage_options&&this.$mi.roles_manage_options.length!==0||this.$mi.roles_view_reports&&this.$mi.roles_view_reports.length!==0)}}};var lt=function(){var t=this,e=t._self._c;return e("div",[t.is_admin?e("a",{staticClass:"exactmetrics-button",attrs:{href:t.reportsUrl},domProps:{textContent:t._s(t.text_view_reports)}}):t.licenseType==="basic"?e("a",{staticClass:"exactmetrics-button",attrs:{target:"_blank",rel:"noopener",href:t.upgradeUrl},domProps:{textContent:t._s(t.text_button)}}):!t.is_admin&&t.canManageOptions&&!t.isPageInsights?e("a",{staticClass:"exactmetrics-button",attrs:{href:t.install_url},domProps:{textContent:t._s(t.text_install)}}):!t.is_admin&&!t.canManageOptions?e("a",{staticClass:"exactmetrics-button",attrs:{href:t.reportsUrl},domProps:{textContent:t._s(t.text_view_reports)}}):t._e()])},dt=[],_t=i(ct,lt,dt,!1,null,null,null,null);const mt=_t.exports,{__:ut,_n:pt,sprintf:ft}=wp.i18n,ht={name:"FrontendInfoboxChange",props:{value:String,days:Number,change:Number,color:{default:"green",type:String},direction:{default:"up",type:String}},computed:{compare(){return pt("vs. Previous Day",ft("vs. Previous %s Days",this.days),this.days,"exactmetrics-premium")},changeClass(){let s="exactmetrics-reports-infobox-prev";return this.change===0?s:s+" exactmetrics-"+this.color},changeText(){return this.change?this.direction===""?this.change+"%":'<span class="exactmetrics-arrow exactmetrics-'+this.direction+" exactmetrics-"+this.color+'"></span> '+this.change+"%":ut("No change","exactmetrics-premium")}}};var gt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"exactmetrics-frontend-infobox-change"},[e("div",{class:t.changeClass,domProps:{innerHTML:t._s(t.changeText)}}),t.days?e("div",{staticClass:"exactmetrics-reports-infobox-compare",domProps:{textContent:t._s(t.compare)}}):t._e()])},vt=[],xt=i(ht,gt,vt,!1,null,null,null,null);const bt=xt.exports,{__:a}=wp.i18n,$t={name:"FrontendStatsGeneral",components:{NotificationsIndicator:f,FrontendInfoboxChange:bt,FrontendUpsell:mt,FrontendStatsColumn:p},data(){return{text_insights_for:a("Last 30 Days Analytics for ","exactmetrics-premium"),text_your_website:a("Your Website","exactmetrics-premium"),text_sessions:a("Sessions","exactmetrics-premium"),text_pageviews:a("Pageviews","exactmetrics-premium"),text_session_duration:a("Avg. Duration","exactmetrics-premium"),text_total_users:a("Total Users","exactmetrics-premium")}},computed:{...r({overview:"$_reports/overview"}),text_upsell_title(){return this.$mi.is_admin?a("More data is available","exactmetrics-premium"):a("Want to see page-specific stats?","exactmetrics-premium")},infoboxRange(){return this.overview.infobox&&this.overview.infobox.range?this.overview.infobox.range:0},infoboxSessionsData(){return this.infoboxData("sessions")},infoboxPageviewsData(){return this.infoboxData("pageviews")},infoboxDurationData(){return this.infoboxData("duration")},hasTotalUsersData(){return typeof this.infoboxTotalUsersData.value<"u"},infoboxTotalUsersData(){return this.infoboxData("totalusers")}},methods:{infoboxData(s,t=!1){let e={};return this.overview.infobox&&this.overview.infobox[s]&&(e.change=this.overview.infobox[s].prev,e.value=this.overview.infobox[s].value.toString(),this.overview.infobox[s].prev===0?e.direction="":this.overview.infobox[s].prev>0?(e.direction="up",e.color="green"):(e.direction="down",e.color="red")),t&&(e.direction==="down"?e.color="green":e.color="red"),e}},mounted(){if(!this.$mi.authed){this.$store.commit("$_frontend/ENABLE_NOAUTH");return}this.$store.dispatch("$_reports/getReportData","overview").then(()=>{this.$store.commit("$_frontend/UPDATE_LOADED",!0)})}};var wt=function(){var t=this,e=t._self._c;return t.overview.infobox?e("div",{staticClass:"exactmetrics-frontend-stats-inner"},[e("h3",[e("span",{domProps:{textContent:t._s(t.text_insights_for)}}),e("span",{domProps:{textContent:t._s(t.text_your_website)}})]),e("div",{staticClass:"exactmetrics-frontend-stats-grey-area"},[e("frontend-stats-column",{attrs:{label:t.text_sessions,value:t.overview.infobox.sessions.value}},[e("frontend-infobox-change",{attrs:{change:t.infoboxSessionsData.change,color:t.infoboxSessionsData.color,direction:t.infoboxSessionsData.direction,days:t.infoboxRange}})],1),e("frontend-stats-column",{attrs:{label:t.text_pageviews,value:t.overview.infobox.pageviews.value}},[e("frontend-infobox-change",{attrs:{change:t.infoboxPageviewsData.change,color:t.infoboxPageviewsData.color,direction:t.infoboxPageviewsData.direction,days:t.infoboxRange}})],1),e("frontend-stats-column",{attrs:{label:t.text_session_duration,value:t.overview.infobox.duration.value}},[e("frontend-infobox-change",{attrs:{change:t.infoboxDurationData.change,color:t.infoboxDurationData.color,direction:t.infoboxDurationData.direction,days:t.infoboxRange}})],1),t.hasTotalUsersData?e("frontend-stats-column",{attrs:{label:t.text_total_users,value:t.infoboxTotalUsersData.value}},[e("frontend-infobox-change",{attrs:{change:t.infoboxTotalUsersData.change,color:t.infoboxTotalUsersData.color,direction:t.infoboxTotalUsersData.direction,days:t.infoboxRange}})],1):t._e(),e("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-button"},[e("frontend-upsell")],1),e("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-notifications"},[e("notifications-indicator")],1)],1)]):t._e()},Ct=[],Dt=i($t,wt,Ct,!1,null,null,null,null);const yt=Dt.exports,Pt={name:"FrontendStatsContent",components:{FrontendStatsGeneral:yt,FrontendStatsPageInsights:rt},data(){return{loaded:!1}},computed:{...r({license:"$_license/license",license_network:"$_license/license_network",addons:"$_addons/addons"})},mounted(){if(Object.keys(this.addons).length!==0&&this.addons.constructor===Object)return this.loaded=!0;this.$store.dispatch("$_license/getLicense"),this.$store.dispatch("$_addons/getAddons").then(()=>{this.loaded=!0})},methods:{showPageInsights(){return this.addons["page-insights"]&&!this.$mi.is_admin?this.addons["page-insights"].active:!1}}};var Et=function(){var t=this,e=t._self._c;return t.loaded?e("div",{staticClass:"exactmetrics-content-pro"},[t.showPageInsights()?e("frontend-stats-page-insights"):e("frontend-stats-general")],1):t._e()},Rt=[],Tt=i(Pt,Et,Rt,!1,null,null,null,null);const At=Tt.exports,{__:l,sprintf:St}=wp.i18n,Ft={name:"FrontendNoAuth",components:{LaunchWizardButton:E},data(){return{text_no_auth:l("Please Setup Website Analytics to See Audience Insights","exactmetrics-premium"),text_auth_label:l("ExactMetrics, the #1 WordPress Analytics Plugin, helps you connect your website with Google Analytics, so you can see how people find and use your website. Over 3 million website owners use ExactMetrics to see the stats that matter and grow their business.","exactmetrics-premium"),text_wizard:l("Connect ExactMetrics and Setup Website Analytics","exactmetrics-premium"),text_learn:l("Learn More","exactmetrics-premium"),learn_link:this.$mi.getting_started_url,text_onboarding_note:St(l("Note: You will be transfered to %1$s.com to complete the setup wizard.","exactmetrics-premium"),"ExactMetrics")}}};var Ut=function(){var t=this,e=t._self._c;return e("div",{staticClass:"exactmetrics-not-authenticated-notice"},[e("h3",{domProps:{textContent:t._s(t.text_no_auth)}}),e("div",{staticClass:"exactmetrics-settings-input exactmetrics-settings-input-authenticate"},[e("p",{domProps:{textContent:t._s(t.text_auth_label)}}),e("div",[e("LaunchWizardButton",{staticClass:"exactmetrics-wp-button exactmetrics-wp-button-primary",domProps:{textContent:t._s(t.text_wizard)}}),e("a",{staticClass:"exactmetrics-wp-button",attrs:{href:t.learn_link},domProps:{textContent:t._s(t.text_learn)}}),e("p",{domProps:{textContent:t._s(t.text_onboarding_note)}})],1)])])},Ot=[],It=i(Ft,Ut,Ot,!1,null,null,null,null);const Mt=It.exports,Lt={name:"ModuleFrontendReports",components:{FrontendNoAuth:Mt,WidgetReportError:P,FrontendStatsContent:At},data(){return{text_insights:"ExactMetrics",statsVisible:!1,page_id:this.$mi.page_id}},created(){const s="$_reports";s in this.$store._modules.root._children||this.$store.registerModule(s,D);const t="$_frontend";t in this.$store._modules.root._children||this.$store.registerModule(t,Y)},computed:{...r({reportdata:"$_frontend/pageinsights",loaded:"$_frontend/loaded",error:"$_frontend/error",noauth:"$_frontend/noauth",notifications:"$_notifications/notifications"}),toggleButtonClass(){let s="ab-item ab-empty-item exactmetrics-toggle";return this.statsVisible&&(s+=" exactmetrics-toggle-active"),s},has_notifications(){return this.notifications&&this.notifications.length>0}},methods:{toggleStatsVisibility(){this.statsVisible=!this.statsVisible}}};var Nt=function(){var t=this,e=t._self._c;return e("li",{staticClass:"exactmetrics-adminbar-menu-item",attrs:{id:"wp-admin-bar-exactmetrics_frontend_button"}},[e("div",{class:t.toggleButtonClass,on:{click:t.toggleStatsVisibility}},[e("span",{staticClass:"ab-icon dashicons-before dashicons-chart-bar"}),e("span",{staticClass:"exactmetrics-admin-bar-handle-text",domProps:{textContent:t._s(t.text_insights)}}),t.has_notifications?e("span",{staticClass:"exactmetrics-menu-notification-indicator",domProps:{textContent:t._s(t.notifications.length)}}):t._e()]),t.statsVisible?e("div",{staticClass:"exactmetrics-frontend-stats"},[t.noauth?e("frontend-no-auth"):t.error?e("widget-report-error",{attrs:{error:t.error}}):e("frontend-stats-content"),t.loaded?t._e():e("div",{staticClass:"exactmetrics-frontend-stats-loading"},[t._m(0)])],1):t._e()])},kt=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"exactmetrics-roller"},[t("div"),t("div"),t("div"),t("div"),t("div"),t("div"),t("div")])}],Vt=i(Lt,Nt,kt,!1,null,null,null,null);const Wt=Vt.exports;const{__:u}=wp.i18n,Bt={install(s,{store:t}){s.prototype.$mi_loading_toast||(s.prototype.$mi_loading_toast=function(){}),s.prototype.$mi_error_toast||(s.prototype.$mi_error_toast=function(e){let{type:_="error",customContainerClass:c="exactmetrics-swal",allowOutsideClick:h=!1,allowEscapeKey:g=!1,allowEnterKey:v=!1,title:x=u("Error","exactmetrics-premium"),html:b=u("Please try again.","exactmetrics-premium"),footer:$=!1}=e;e={type:_,customContainerClass:c,allowOutsideClick:h,allowEscapeKey:g,allowEnterKey:v,title:x,html:b,footer:$},t.commit("$_frontend/SET_ERROR",{title:e.title,content:e.html,footer:e.footer})}),s.prototype.$mi_intervals=function(){return y}}};window.addEventListener("load",function(){const s=document.getElementById("wp-admin-bar-exactmetrics_frontend_button");n.config.productionTip=!1,s&&({}.NODE_ENV!=="production"&&(n.config.devtools=!0,n.config.performance=!0),C({ctrl:!0}),n.use(R),n.use(Bt,{store:d}),new n({store:d,mounted:()=>{window.pagenow&&window.pagenow!=="dashboard"&&window.pagenow!=="toplevel_page_exactmetrics_reports"&&d.dispatch("$_queue/add",()=>d.dispatch("$_notifications/getNotifications"))},render:t=>t(Wt)}).$mount(s))});
