import{V as a,a as g,h as r}from"./vendor-69fa03c8.min.js";import{r as v,g as o}from"./exactmetrics-helper-plugin-f5be6d27.min.js";const{__:E,sprintf:b}=wp.i18n,D=(t,e,c,n)=>new Promise(s=>{let m=new FormData;m.append("action","exactmetrics_vue_get_report_data"),m.append("nonce",a.prototype.$mi.nonce),m.append("report",e),m.append("start",c),m.append("end",n),t.getters.date.compareReport&&(m.append("compare_report",!0),m.append("compare_end",t.getters.date.compareEnd),m.append("compare_start",t.getters.date.compareStart)),g.post(a.prototype.$mi.ajax,m).then(d=>{s(d.data)}).catch(async function(d){await v("report_fetch_error"),t.dispatch("$_app/block",!1,{root:!0});const u=a.prototype.$getUrl("admin-notices","error-verifying-license","https://www.exactmetrics.com/my-account/support");if(d.response){const p=d.response;return a.prototype.$mi_error_toast({title:b(E("Can't load report data. Error: %1$s, %2$s. Please try again in a few minutes. If the issue persists, please %3$scontact our support%4$s team.","exactmetrics-premium"),p.status,p.statusText,'<a target="_blank" href="'+u+'">',"</a>")})}a.prototype.$swal.hideLoading(),a.prototype.$mi_error_toast({allowOutsideClick:!0,allowEscapeKey:!0,title:E("Error loading report data","exactmetrics-premium"),html:d.message})})}),$=t=>{if(typeof t<"u"){const e=parseInt(t.toString().replace(".",""),10);return e.toString().length===1?parseInt(e===1?e+"00":e+"0"):e}},R=t=>{if(typeof t<"u"){let e={};return Object.keys(t).forEach(function(c){let n=c.toString().split("-").join("_");e[n]=t[c]}),e}},L=t=>new Promise((e,c)=>{const n=new FormData;n.append("action","exactmetrics_vue_capture_last_used_report"),n.append("report",t),n.append("nonce",a.prototype.$mi.nonce),g.post(a.prototype.$mi.ajax,n).then(s=>{e(s.data)}).catch(async function(s){await v("report_capture_error"),c(s)})}),A={fetchReportData:D,getFormattedScore:$,keysReplaceHyphensWithUnderscores:R,captureLastUsedReport:L},{__:i,sprintf:_}=wp.i18n,S=(t,e)=>{const c=["overview","site_summary","yearinreview"];return!a.prototype.$isPro()&&!c.includes(e)?null:new Promise(n=>{if(!a.prototype.$mi.authed)return n(!1),t.commit("ENABLE_BLUR"),t.commit("ENABLE_NOAUTH"),!1;if(t.state.reload_report===!1&&t.state[e]&&t.state[e].reportcurrentrange&&!t.state.date.compareReport&&t.state[e].reportcurrentrange.startDate===t.state.date.start&&t.state[e].reportcurrentrange.endDate===t.state.date.end)return n(!1),t.commit("DISABLE_BLUR"),!1;a.prototype.$mi_loading_toast(),t.commit("ENABLE_BLUR"),t.dispatch("$_queue/add",()=>A.fetchReportData(t,e,t.state.date.start,t.state.date.end).then(function(s){if(t.commit("SET_IS_LOADED"),s.data.message==="license_level"){y(t),n(!1);return}if(s.success)y(t),t.commit("DISABLE_BLUR"),t.commit("UPDATE_REPORT_DATA",{report:e,data:s.data}),n(!0);else{if(s.data.message==="invalid_grant"){y(t),n(!1),t.commit("ENABLE_REAUTH");return}if(s.data.footer&&s.data.footer==="install_addon"){let m=t.state.required_addon?t.state.required_addon:e;O(t,m).then(function(d){t.rootState.$_widget&&(t.commit("DISABLE_BLUR"),t.commit("$_widget/UPDATE_LOADED",!0,{root:!0}));let u=i(d?"activate":"install","exactmetrics-premium");a.prototype.$mi_error_toast({title:!1,html:_(s.data.message,u),footer:'<a href="'+a.prototype.$mi.addons_url+'">'+i("Visit addons page","exactmetrics-premium")+"</a>",report:e}),a.prototype.$swal({icon:"error",customClass:{container:"exactmetrics-swal"},title:i("Report Unavailable","exactmetrics-premium"),html:_(s.data.message,u),allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:_(i("%s Addon","exactmetrics-premium"),u.charAt(0).toUpperCase()+u.slice(1)),cancelButtonText:i("Dismiss","exactmetrics-premium")}).then(function(p){p.value&&(d?h(t,t.rootState.$_addons.addons[m]):T(t,m))})})}else s.data.footer&&s.data.footer.indexOf("#/ecommerce")>0?(n(!1),a.prototype.$mi_error_toast({title:!1,html:s.data.message,report:e,showCancelButton:!0,cancelButtonText:i("Go Back To Reports","exactmetrics-premium"),confirmButtonText:i("Enable Enhanced eCommerce","exactmetrics-premium")}).then(function(m){m.value&&(window.location=s.data.footer)})):s.data.type&&s.data.type==="expired_license"?(n(!1),a.prototype.$mi_error_toast({type:"",customClass:{container:"exactmetrics-expired-license-alert-toast"},confirmButtonText:"",title:!1,html:s.data.message,footer:s.data.footer,report:e})):(n(!1),a.prototype.$mi_error_toast({title:!1,html:s.data.message,footer:s.data.footer,report:e,onClose:()=>{if(!s.data.type||s.data.type!=="INVALID_DATE_RANGE"||t.state.date==="last30days")return;const m=a.prototype.$mi_intervals().last30days;t.commit("UPDATE_INTERVAL","last30days"),t.commit("UPDATE_DATE",{start:m.start.format("YYYY-MM-DD"),end:m.end.format("YYYY-MM-DD")}),t.dispatch("getReportData",t.state.activeReport)}}))}}),{root:!0})})};function O(t,e){return new Promise(function(c){t.dispatch("$_addons/getAddons","",{root:!0}).then(function(){t.rootState.$_addons.addons[e]&&t.rootState.$_addons.addons[e].installed?c(!0):c(!1)}).catch(function(){c(!1),w()})})}function T(t,e){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:i("Installing Addon","exactmetrics-premium"),html:i("Please wait","exactmetrics-premium"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),t.dispatch("$_addons/installAddon",t.rootState.$_addons.addons[e],{root:!0}).then(function(){h(t,t.rootState.$_addons.addons[e])}).catch(function(){w()})}})}function h(t,e){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:i("Activating Addon","exactmetrics-premium"),html:i("Please wait","exactmetrics-premium"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}),t.dispatch("$_addons/activateAddon",e,{root:!0}).then(function(){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:i("Addon Activated","exactmetrics-premium"),html:i("Loading report data","exactmetrics-premium"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),setTimeout(function(){window.location.reload()},1e3)}})}).catch(function(c){w(c)})}function w(t){let e=i("Please activate manually","exactmetrics-premium");t.response&&(e=_(i("Error: %1$s, %2$s","exactmetrics-premium"),t.response.status,t.response.statusText)),a.prototype.$swal({icon:"error",customClass:{container:"exactmetrics-swal"},title:i("Error Activating Addon","exactmetrics-premium"),html:e,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:i("View Addons","exactmetrics-premium"),cancelButtonText:i("Dismiss","exactmetrics-premium")}).then(function(c){c.value&&(window.location=a.prototype.$mi.addons_url,a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:i("Redirecting","exactmetrics-premium"),html:i("Please wait","exactmetrics-premium"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}))})}function y(t){t.rootState.$_widget||typeof a.prototype.$swal=="function"&&a.prototype.$swal.close()}const B=(t,e)=>{A.captureLastUsedReport(e)},U={getReportData:S,installAddon:T,activateAddon:h,captureLastUsedReport:B},C=t=>t.yearinreview_data,P=t=>t.activeReport,Y=t=>t.isLoaded,x=t=>t.blur,I=t=>t.mobileTableExpanded,k=t=>t.overview,M=t=>t.site_summary,N=t=>t.publisher,K=t=>t.ecommerce,q=t=>t.ecommerce_coupons,V=t=>t.ecommerce_funnel,H=t=>t.cart_abandonment,F=t=>t.ecommerce_product_feed,j=t=>t.queries,G=t=>t.dimensions,W=t=>t.forms,X=t=>t.realtime,Q=t=>t.yearinreview,z=t=>t.sitespeed,J=t=>t.sitespeedmobile,Z=t=>t.noauth,tt=t=>t.reauth,et=t=>t.media,at=t=>t.countries,rt=t=>t.traffic_overview,st=t=>t.traffic_landing_pages,ot=t=>t.traffic_technology,nt=t=>t.traffic_campaign,it=t=>t.traffic_source_medium,ct=t=>t.traffic_social,mt=t=>t.traffic_ai,dt=t=>t.engagement_pages,lt=t=>t.custom_events,ut=()=>o("overview"),pt=()=>o("ecommerce"),ft=()=>o("ecommerce_coupons"),_t=()=>o("cart_abandonment"),yt=()=>o("dimensions"),ht=()=>o("countries"),wt=()=>o("traffic_overview"),Et=()=>o("traffic_technology"),gt=()=>o("traffic_landing_pages"),vt=()=>o("traffic_campaign"),At=()=>o("traffic_source_medium"),Tt=()=>o("traffic_social"),bt=()=>o("traffic_ai"),Dt=()=>o("publisher"),$t=()=>o("engagement_pages"),Rt=()=>o("queries"),Lt=()=>o("forms"),St=()=>o("realtime"),Ot=()=>o("sitespeed"),Bt=()=>o("media"),Ut=()=>o("ecommerce_funnel"),Ct=()=>o("ecommerce_product_feed"),Pt=()=>o("custom_events");function f(t,e){return t.format("YYYYMMDD")===e.format("YYYYMMDD")?t.format("MMM D, YYYY"):t.format("MMM D")+" - "+e.format("MMM D, YYYY")}function Yt(t){let e=t.date,c=a.prototype.$mi_intervals();if(c[e.interval]){let n=c[e.interval];e.intervalText=f(n.start,n.end),e.intervalCompareText=f(n.compareStart,n.compareEnd)}else e.intervalText=f(r(e.start),r(e.end)),e.intervalCompareText=f(r(e.compareStart),r(e.compareEnd));return e}const xt={yearinreview_data:C,date:Yt,activeReport:P,isLoaded:Y,blur:x,mobileTableExpanded:I,overview:k,publisher:N,ecommerce:K,ecommerce_coupons:q,ecommerce_funnel:V,cart_abandonment:H,ecommerce_product_feed:F,queries:j,dimensions:G,forms:W,realtime:X,noauth:Z,yearinreview:Q,reauth:tt,sitespeed:z,sitespeedmobile:J,site_summary:M,media:et,countries:at,traffic_overview:rt,traffic_landing_pages:st,traffic_technology:ot,traffic_campaign:nt,traffic_source_medium:it,traffic_social:ct,traffic_ai:mt,engagement_pages:dt,custom_events:lt,demo_overview:ut,demo_ecommerce:pt,demo_ecommerce_coupons:ft,demo_cart_abandonment:_t,demo_dimensions:yt,demo_countries:ht,demo_traffic_overview:wt,demo_traffic_technology:Et,demo_traffic_landing_pages:gt,demo_traffic_campaign:vt,demo_traffic_source_medium:At,demo_traffic_social:Tt,demo_traffic_ai:bt,demo_publisher:Dt,demo_engagement_pages:$t,demo_queries:Rt,demo_forms:Lt,demo_realtime:St,demo_sitespeed:Ot,demo_media:Bt,demo_ecommerce_funnel:Ut,demo_ecommerce_product_feed:Ct,demo_custom_events:Pt},It=(t,e)=>{e.report&&e.data&&t[e.report]&&a.set(t,e.report,e.data)},kt=(t,e)=>{e.start&&e.end&&(a.set(t.date,"start",e.start),a.set(t.date,"end",e.end))},Mt=(t,e)=>{a.set(t.date,"interval",e)},Nt=(t,e)=>{a.set(t.date,"text",e)},Kt=(t,e)=>{t.activeReport=e},qt=t=>{t.isLoaded=!0},Vt=t=>{t.blur=!0},Ht=t=>{t.blur=!1},Ft=t=>{t.mobileTableExpanded=!0},jt=t=>{t.mobileTableExpanded=!1},Gt=t=>{t.noauth=!0},Wt=t=>{t.reauth=!0},Xt=t=>{t.reload_report=!0},Qt=t=>{t.reload_report=!1},zt=(t,e)=>{t.required_addon=e},Jt=(t,e)=>{t.date={...t.date,...e}},Zt={UPDATE_REPORT_DATA:It,UPDATE_DATE:kt,UPDATE_ACTIVE_REPORT:Kt,UPDATE_INTERVAL:Mt,UPDATE_DATE_TEXT:Nt,SET_IS_LOADED:qt,ENABLE_BLUR:Vt,DISABLE_BLUR:Ht,EXPAND_TABLES:Ft,CONTRACT_TABLES:jt,ENABLE_NOAUTH:Gt,ENABLE_REAUTH:Wt,UPDATE_REQUIRED_ADDON:zt,UPDATE_DATE_STORE:Jt,ENABLE_REPORT_RELOAD:Xt,DISABLE_REPORT_RELOAD:Qt},te={yearinreview_data:window.exactmetrics.yearinreview,date:{start:"",end:"",interval:"last30days",text:"",compareText:"",compareReport:!1,compareStart:"",compareEnd:""},blur:!1,activeReport:"overview",mobileTableExpanded:!1,overview:{},site_summary:{},publisher:{},ecommerce:{},ecommerce_coupons:{},ecommerce_funnel:{funnel_table:{none:[]},funnel_chart:[]},cart_abandonment:{},queries:{},dimensions:{},forms:{},realtime:{},yearinreview:{},sitespeed:{},sitespeedmobile:{},noauth:!1,reauth:!1,isLoaded:!1,media:{line_chart_report:{},video_details_rows:[]},countries:{},traffic_overview:{},traffic_landing_pages:{},traffic_technology:{},traffic_campaign:{},traffic_source_medium:{},traffic_social:{sessions_chart:{}},traffic_ai:{sessions_chart:{},ai_table:[]},engagement_pages:{},required_addon:null,reload_report:!1,ecommerce_product_feed:{},custom_events:{sessions_chart:{}}},re={namespaced:!0,state:te,actions:U,getters:xt,mutations:Zt},{__:l}=wp.i18n,se={today:{text:l("Today","exactmetrics-premium"),start:r(),end:r(),interval:"today",compareStart:r().subtract(1,"days"),compareEnd:r().subtract(1,"days")},yesterday:{text:l("Yesterday","exactmetrics-premium"),start:r().subtract(1,"days"),end:r().subtract(1,"days"),interval:"yesterday",compareStart:r().subtract(2,"days"),compareEnd:r().subtract(2,"days")},lastweek:{text:l("Last Week","exactmetrics-premium"),end:r().startOf("week"),start:r().startOf("week").subtract(6,"days"),interval:"lastweek",compareStart:r().startOf("week").subtract(13,"days"),compareEnd:r().startOf("week").subtract(7,"days")},lastmonth:{text:l("Last Month","exactmetrics-premium"),end:r().startOf("month").subtract(1,"days"),start:r().startOf("month").subtract(1,"month"),interval:"lastmonth",compareStart:r().startOf("month").subtract(2,"month"),compareEnd:r().startOf("month").subtract(1,"month").subtract(1,"days")},last7days:{text:l("Last 7 days","exactmetrics-premium"),end:r().subtract(1,"days"),start:r().subtract(7,"days"),interval:"last7days",compareStart:r().subtract(14,"days"),compareEnd:r().subtract(8,"days")},last30days:{text:l("Last 30 days","exactmetrics-premium"),end:r().subtract(1,"days"),start:r().subtract(30,"days"),interval:"last30days",compareStart:r().subtract(60,"days"),compareEnd:r().subtract(31,"days")},last90days:{text:l("Last 90 days","exactmetrics-premium"),end:r().subtract(1,"days"),start:r().subtract(90,"days"),interval:"last90days",compareStart:r().subtract(180,"days"),compareEnd:r().subtract(91,"days")}};export{se as D,re as R,h as a,A as h,T as i};
